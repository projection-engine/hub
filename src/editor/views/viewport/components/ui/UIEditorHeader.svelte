<script>
    import Localization from "../../../../../shared/libs/Localization";
    import Icon from "../../../../../shared/components/icon/Icon.svelte";
    import {COMPONENTS, Engine, Entity} from "../../../../../../public/engine/production";
    import SelectionStore from "../../../../stores/SelectionStore";
    import GIZMOS from "../../../../data/GIZMOS";
    import SettingsStore from "../../../../stores/SettingsStore";
    import dispatchRendererEntities, {ENTITY_ACTIONS} from "../../../../stores/templates/dispatch-renderer-entities";

    export let settings
    const translate = (key) => Localization.PROJECT.VIEWPORT[key]



    function selectAll() {
        const m = [], size = Engine.entities.length
        for (let i = 0; i < size; i++) {
            const e = Engine.entities[i]
            if (e.components.get(COMPONENTS.UI) != null)
                m.push(e.id)
        }
        SelectionStore.engineSelected = m
    }
    $: isOnSelection = settings.gizmo === GIZMOS.NONE
    function toggleSelection(){
        if(isOnSelection)
            SettingsStore.updateStore({...settings, gizmo: GIZMOS.TRANSLATION})
        else
            SettingsStore.updateStore({...settings, gizmo: GIZMOS.NONE})
    }
    function addUiElement() {
        const e = new Entity(undefined, "UI-Node")
        e.addComponent(COMPONENTS.UI)
        dispatchRendererEntities({type: ENTITY_ACTIONS.ADD, payload: e})
    }
</script>

<div class="left-content">
    <button on:click={addUiElement}>
        <Icon styles="font-size: .9rem">add</Icon>
        {translate("ADD_ELEMENT")}
    </button>
    <button on:click={selectAll}>
        {translate("SELECT_ALL")}
    </button>
</div>

<div class="right-content">
    <button data-highlight={isOnSelection ? "-" : ""} on:click={toggleSelection}>
        <Icon>
            highlight_alt
        </Icon>
        {translate("PICKER")}
    </button>
</div>

<style>

    .left-content {
        display: flex;
        align-items: center;
        gap: 4px;
        justify-content: flex-start;
        width: 100%;

    }

    .right-content {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        width: 100%;
    }
    button {
        display: flex;
        gap: 4px;
        align-items: center;
        padding: 0 4px;
        font-size: 0.7rem !important;

        border: none;
    }
</style>